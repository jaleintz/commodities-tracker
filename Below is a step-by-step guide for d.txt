Below is a step-by-step guide for deploying a full-stack React app (using Vite for the frontend, Node.js for the backend, and Supabase for the PostgreSQL database) to Railway, with code stored in a GitHub repository. This guide assumes you're using a monorepo for simplicity, but it can be adapted for separate frontend and backend repos. I'll include specific instructions for Vite (React) and Node.js (e.g., Express), and how to integrate Supabase's database, covering setup, deployment, and testing.PrerequisitesGitHub Account: For storing your code.
Railway Account: Sign up at railway.app.
Supabase Account: Sign up at app.supabase.com for the database.
Node.js and npm: Installed locally for development.
App Structure: A full-stack app with a React (Vite) frontend, Node.js (Express) backend, and Supabase PostgreSQL database.

Step-by-Step Deployment1. Set Up Your Supabase DatabaseCreate a Supabase Project:Log in to app.supabase.com and create a new project (e.g., my-fullstack-app-db).
Wait for the project to initialize (1-2 minutes).

Set Up Database Schema:Use Supabase’s Table Editor or SQL Editor to create tables (e.g., users table: id SERIAL PRIMARY KEY, name TEXT, email TEXT).
Example SQL:sql

CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name TEXT NOT NULL,
  email TEXT UNIQUE NOT NULL
);

Enable Row Level Security (RLS) for production (in Authentication > Policies) to secure data access.

Get Connection Details:Go to Settings > Database in Supabase.
Copy the Connection String (e.g., postgresql://[user]:[password]@[host]:[port]/[dbname]).
If using Supabase’s client library, also copy the API URL and Anon Key from Settings > API.

Test Locally:Install a PostgreSQL client like pg (npm install pg) or Supabase’s client (npm install @supabase/supabase-js) in your backend.
Test the connection locally using a .env file:env

DATABASE_URL=postgresql://[user]:[password]@[host]:[port]/[dbname]

2. Set Up Your GitHub RepositoryMonorepo Structure:
Create a monorepo for your frontend and backend:

/my-fullstack-app
├── /frontend
│   ├── package.json (Vite scripts for React)
│   ├── /src (React components)
│   ├── /public
│   └── vite.config.js
├── /backend
│   ├── package.json (Node.js scripts for Express)
│   ├── server.js (Express server)
│   └── /routes
└── README.md

Initialize Git:Run git init, create a .gitignore (excluding node_modules, .env, frontend/dist), and commit:bash

git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/your-username/my-fullstack-app.git
git push -u origin main

3. Configure the Frontend (React with Vite)Set Up Vite Project:If not already set up, create a Vite React project in /frontend:bash

cd frontend
npm create vite@latest . -- --template react
npm install

Test locally: npm run dev (runs on http://localhost:5173 by default).

Production Build:Update package.json for production serving:json

{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "start": "vite preview --host"
  }
}

Run npm run build to create the /dist folder (Vite’s output).
Note: Railway supports Vite natively, but for static hosting, you may use a lightweight server or Railway’s static file serving.

Environment Variables:If the frontend calls the backend or Supabase directly, create a .env file in /frontend:env

VITE_API_URL=https://backend.up.railway.app
VITE_SUPABASE_URL=https://your-supabase-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key

Prefix variables with VITE_ for Vite to expose them to the frontend (e.g., import.meta.env.VITE_API_URL).

Supabase Client (Optional):If the frontend queries Supabase directly (e.g., for auth or data), install @supabase/supabase-js:bash

cd frontend
npm install @supabase/supabase-js

Initialize Supabase in your React app (e.g., /src/supabase.js):javascript

import { createClient } from '@supabase/supabase-js';
const supabase = createClient(
  import.meta.env.VITE_SUPABASE_URL,
  import.meta.env.VITE_SUPABASE_ANON_KEY
);
export default supabase;

Example query:javascript

import supabase from './supabase';
const fetchUsers = async () => {
  const { data, error } = await supabase.from('users').select('*');
  if (error) console.error(error);
  return data;
};

4. Configure the Backend (Node.js with Express)Set Up Express:In /backend, initialize a Node.js project:bash

cd backend
npm init -y
npm install express pg

Create server.js:javascript

const express = require('express');
const { Pool } = require('pg');
const cors = require('cors');
const app = express();

app.use(cors({ origin: process.env.FRONTEND_URL }));
app.use(express.json());

const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
  ssl: { rejectUnauthorized: false }
});

// Example route
app.get('/api/users', async (req, res) => {
  try {
    const { rows } = await pool.query('SELECT * FROM users');
    res.json(rows);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});

app.listen(process.env.PORT || 3000, () => {
  console.log('Server running on port', process.env.PORT || 3000);
});

Update package.json:json

{
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "pg": "^8.11.0",
    "cors": "^2.8.5"
  }
}

Supabase Connection:Alternatively, use @supabase/supabase-js for the backend:bash

npm install @supabase/supabase-js

javascript

const { createClient } = require('@supabase/supabase-js');
const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_SERVICE_KEY // Use service key for backend
);
app.get('/api/users', async (req, res) => {
  const { data, error } = await supabase.from('users').select('*');
  if (error) return res.status(500).json({ error });
  res.json(data);
});

Test Locally:Create a .env file in /backend:env

DATABASE_URL=postgresql://[user]:[password]@[host]:[port]/[dbname]
SUPABASE_URL=https://your-supabase-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-key
FRONTEND_URL=http://localhost:5173

Run npm start and test endpoints (e.g., http://localhost:3000/api/users).

5. Push to GitHubCommit and push your code:bash

git add .
git commit -m "Set up frontend and backend"
git push origin main

6. Deploy to RailwayCreate a Railway Project:Log in to railway.app.
Click New Project > Deploy from GitHub repo.
Authorize GitHub and select your my-fullstack-app repo.

Add Services:Frontend Service:Select the /frontend folder in the monorepo.
Railway detects Vite and runs npm install, npm run build, and npm start.
If using vite preview, ensure "start": "vite preview --host" is in package.json. Alternatively, use a static server like serve (npm install serve, "start": "serve -s dist").
Railway may suggest a Nixpacks or Dockerfile for static hosting; accept defaults or use a Caddy-based template for efficiency.

Backend Service:Select the /backend folder.
Set the start command to npm start (or node server.js).
Ensure the backend listens on process.env.PORT.

Environment Variables:Frontend (in Railway’s Variables tab for the frontend service):VITE_API_URL: Set to the backend’s Railway URL (e.g., https://backend.up.railway.app) after deployment.
VITE_SUPABASE_URL: From Supabase’s Settings > API (e.g., https://your-supabase-project.supabase.co).
VITE_SUPABASE_ANON_KEY: From Supabase’s Settings > API.

Backend (in Railway’s Variables tab for the backend service):DATABASE_URL: Paste Supabase’s connection string.
SUPABASE_URL and SUPABASE_SERVICE_KEY (if using @supabase/supabase-js).
FRONTEND_URL: Set to the frontend’s Railway URL (e.g., https://frontend.up.railway.app) for CORS.

Variables are encrypted and injected at runtime.

Deploy:Click Deploy for each service.
Railway builds and deploys, assigning URLs (e.g., frontend.up.railway.app, backend.up.railway.app).
Make URLs public in Settings if needed.

7. Configure Supabase IntegrationDatabase Connection:The backend uses DATABASE_URL (or SUPABASE_URL/SUPABASE_SERVICE_KEY) to connect to Supabase.
Test connectivity by calling a backend endpoint that queries Supabase (e.g., GET /api/users).

CORS for Frontend:If the frontend uses Supabase’s client directly, add the frontend’s Railway URL to Supabase:Go to Authentication > URL Configuration > Additional Redirect URLs in Supabase.
Add https://frontend.up.railway.app.

For backend CORS, ensure FRONTEND_URL allows the frontend URL:javascript

app.use(cors({ origin: process.env.FRONTEND_URL }));

Authentication (Optional):If using Supabase Auth, initialize it in the frontend:javascript

import supabase from './supabase';
const login = async (email, password) => {
  const { user, error } = await supabase.auth.signInWithPassword({ email, password });
  if (error) console.error(error);
  return user;
};

Manage users in Supabase’s Authentication dashboard.

8. Test and MonitorVerify Deployment:Visit frontend.up.railway.app to ensure the React app loads.
Test backend endpoints (e.g., backend.up.railway.app/api/users) to confirm Supabase connectivity.
If using Supabase Auth, test login/signup flows.

Logs:Check Railway’s Logs tab for build or runtime errors.
Use Supabase’s Logs or Reports to monitor database usage.

Auto-Deploy:Enable GitHub integration in Railway to auto-deploy on git push.

9. Optional: Database MigrationsIf managing schema programmatically, use a tool like Knex.js in the backend:bash

cd backend
npm install knex

javascript

const knex = require('knex')({ client: 'pg', connection: process.env.DATABASE_URL });
knex.schema.createTable('users', table => {
  table.increments('id').primary();
  table.string('name');
  table.string('email').unique();
}).then(() => console.log('Table created'));

Add a migration script to package.json (e.g., "migrate": "knex migrate:latest") and run it post-deployment via Railway’s Deployments settings.

CostsRailway: Hobby plan ($5/month) includes $5 credit, covering small frontend/backend deployments. Usage-based billing applies for high traffic (~$0.000463/GB RAM-second).
Supabase: Free tier (500MB storage, 1GB bandwidth/month) is sufficient for small apps. Paid plans start at $25/month. Check supabase.com/pricing.
GitHub: Free for public/private repos.

Common Issues and FixesBuild Fails:Check Railway logs for missing dependencies or incorrect package.json scripts.
Ensure /frontend and /backend paths are correctly set in Railway for a monorepo.

Database Connection Errors:Verify DATABASE_URL matches Supabase’s connection string.
Add ssl: { rejectUnauthorized: false } for pg connections.
Check Supabase’s connection limits (free tier: 50 concurrent connections).

CORS Issues:Ensure FRONTEND_URL is set in the backend and matches the frontend’s Railway URL.
Add the frontend URL to Supabase’s redirect URLs for auth.

Vite-Specific:If vite preview fails on Railway, switch to serve (npm install serve, "start": "serve -s dist") or use Railway’s static hosting.

ResourcesRailway Docs: Node.js
Supabase Docs: Node.js
Vite Docs
Railway Template: React + Node

If you encounter errors or need help with specific code (e.g., package.json, Supabase queries), share details, and I’ll provide targeted fixes!

